=============================================================================
           MANUAL DO SISTEMA: GERADOR DE RELAT√ìRIOS (EXCEL)
=============================================================================

ESTE MANUAL REFERE-SE AO ARQUIVO: executar.bat (e processador_excel.py)

O objetivo deste m√≥dulo √© ler todas as faturas em PDF baixadas pelo rob√¥, 
extrair os dados t√©cnicos e financeiros, e gerar um relat√≥rio Excel 
profissional e formatado.

=============================================================================
                           1. O MENU PRINCIPAL
=============================================================================

Ao iniciar o programa, voc√™ ver√° 5 op√ß√µes. Veja o que cada uma faz:

[1] üé® Criar relat√≥rio profissional (Excel formatado)
    - ESTA √â A OP√á√ÉO PRINCIPAL.
    - O sistema pedir√° um M√™s de Refer√™ncia (ex: 02/2026).
    - Ele ler√° TODOS os PDFs na pasta 'output/faturas'.
    - Aplicar√° a "Regra da Data de Leitura" (Dia 12) para filtrar apenas 
      o que pertence a esse ciclo.
    - Gera o arquivo Excel final na pasta 'output/relatorios'.

[2] üîç Testar extra√ß√£o de um arquivo
    - Modo de diagn√≥stico.
    - Lista os PDFs e permite que voc√™ escolha um √∫nico arquivo.
    - O sistema mostra na tela preta tudo que conseguiu ler daquele PDF.
    - Use isso se uma fatura espec√≠fica estiver vindo com dados zerados.

[3] üìä Ver estat√≠sticas das pastas
    - Mostra quantos arquivos existem na pasta de faturas e o tamanho total.
    - Serve para conferir se o Rob√¥ de Download baixou tudo corretamente.

[4] üìñ Ver estrutura do relat√≥rio
    - Mostra na tela a lista de colunas que ser√£o geradas (igual ao item 3 deste manual).

[5] üö™ Sair
    - Fecha o programa.

=============================================================================
                     2. DICION√ÅRIO DE DADOS (COLUNAS DO EXCEL)
=============================================================================

Abaixo est√° a explica√ß√£o detalhada de cada coluna gerada no relat√≥rio Excel,
identificada pela letra da coluna e o dado que ela cont√©m.

--- GRUPO: IDENTIFICA√á√ÉO (AZUL) ---
A | UC (Conta Contrato)
  - N√∫mero √∫nico que identifica a unidade consumidora na Equatorial.
  - Usado como chave para buscar o nome do cliente.

B | INSTALA√á√ÉO
  - N√∫mero f√≠sico da instala√ß√£o/medidor.

C | NOME CLIENTE
  - Nome do cliente trazido da base de dados (Cad_RateioConsumo_Final.xlsx).
  - Se estiver "N√ÉO ENCONTRADO", significa que a UC do PDF n√£o est√° na planilha base.

D | ID CLIENTE
  - C√≥digo interno do cliente (se houver na planilha base).

E | STATUS
  - "‚úÖ OK": Dados cruzados com sucesso.
  - "‚ö†Ô∏è SEM BASE": A fatura foi lida, mas n√£o sabemos de quem √© (UC nova ou erro no cadastro).

--- GRUPO: DATAS (LARANJA) ---
F | M√äS REF
  - O m√™s que est√° escrito no PDF da fatura (ex: 01/2026).
  - CUIDADO: A Equatorial √†s vezes emite refer√™ncia de Janeiro com leitura em Fevereiro.

G | M√äS COMPET√äNCIA (C√ÅLCULO AUTOM√ÅTICO)
  - Esta √© a data REAL para fins de contabilidade.
  - Regra aplicada: Se a leitura foi feita at√© o dia 12, conta como m√™s atual. 
    Se foi ap√≥s dia 12, conta como m√™s seguinte.

H | VENCIMENTO
  - Data limite para pagamento da fatura.

I | DATA EMISS√ÉO
  - Data em que a nota fiscal foi gerada pela Equatorial.

J | LEITURA ANTERIOR
  - Data em que foi feita a medi√ß√£o do m√™s passado.

K | DATA LEITURA
  - Data da medi√ß√£o atual. √â esta data que define a coluna "G" (Compet√™ncia).

L | PR√ìXIMA LEITURA
  - Previs√£o da pr√≥xima visita do leiturista.

--- GRUPO: MEDI√á√ÉO E GERA√á√ÉO (VERDE) ---
M | MEDIDOR ANTERIOR (kWh)
  - O n√∫mero que estava no rel√≥gio m√™s passado.

N | MEDIDOR ATUAL (kWh)
  - O n√∫mero que est√° no rel√≥gio este m√™s.

O | CONSUMO MEDIDO (kWh)
  - Quanto foi consumido da rede da Equatorial.

P | ENERGIA COMP. (kWh)
  - Energia Compensada (Gera√ß√£o Distribu√≠da/Solar).
  - √â a quantidade de energia que foi abatida da conta gra√ßas √† usina solar.

Q | SALDO ACUMULADO (kWh)
  - O "banco de cr√©ditos" de energia solar que a unidade ainda possui.

--- GRUPO: VALORES FINANCEIROS (VERMELHO) ---
R | VALOR TOTAL (R$)
  - O valor final do boleto a pagar.

S | VALOR CONSUMO (R$)
  - Quanto custaria a energia se n√£o houvesse energia solar.

T | VALOR COMPENSADO (R$)
  - O valor em Reais que foi economizado/abatido pela energia solar.

U | VALOR ENERGIA INJ. (R$)
  - Valor referente √† taxa de inje√ß√£o (quando aplic√°vel).

V | CIP (R$)
  - Contribui√ß√£o de Ilumina√ß√£o P√∫blica (taxa da prefeitura).

W | ADIC. BANDEIRA (R$)
  - Valor extra pago se a bandeira tarif√°ria for Amarela ou Vermelha.

--- GRUPO: PRE√áOS UNIT√ÅRIOS (ROXO) ---
X | PRE√áO UNIT. CONSUMO (R$/kWh)
  - Pre√ßo do kWh cobrado pela Equatorial (Tarifa cheia com impostos).

Y | PRE√áO UNIT. COMPENSADO (R$/kWh)
  - Pre√ßo do kWh usado para calcular o cr√©dito solar.

--- GRUPO: TRIBUTOS - VALORES (AZUL CLARO) ---
Z  | ICMS (R$)   - Valor monet√°rio pago de ICMS.
AA | PIS (R$)    - Valor monet√°rio pago de PIS.
AB | COFINS (R$) - Valor monet√°rio pago de COFINS.

--- GRUPO: TRIBUTOS - AL√çQUOTAS (ROSA) ---
AC | ICMS (%)    - Porcentagem aplicada (ex: 18%, 27%).
AD | PIS (%)     - Porcentagem do PIS.
AE | COFINS (%)  - Porcentagem do COFINS.

--- GRUPO: INFORMA√á√ïES T√âCNICAS (MARROM) ---
AF | TIPO FORNECIMENTO
  - Ex: Monof√°sico, Bif√°sico, Trif√°sico.

AG | CLASSIFICA√á√ÉO
  - Ex: B1 Residencial, B2 Rural, B3 Comercial.

AH | COR DA BANDEIRA
  - Campo visual importante.
  - O Excel pintar√° esta c√©lula de VERDE, AMARELO ou VERMELHO automaticamente.
  - Indica se houve taxa extra de escassez h√≠drica.

AI | BANDEIRA TARIF. (INFO)
  - Texto completo descritivo da bandeira (ex: "Escassez H√≠drica Patamar 2").

--- GRUPO: CONTROLE (CINZA) ---
AJ | ARQUIVO
  - Nome do arquivo PDF de onde os dados foram tirados. √ötil para auditoria.

AK | ERRO EXTRA√á√ÉO
  - Se esta coluna tiver texto, houve algum problema ao ler o PDF.
  - Ex: "Valor total n√£o encontrado".
  - Verifique o PDF manualmente nestes casos.

=============================================================================
                           OBSERVA√á√ïES FINAIS
=============================================================================
1. As colunas coloridas facilitam a leitura visual por grupos (Financeiro, T√©cnico, Datas).
2. O sistema gera uma aba "RESUMO" e "ESTAT√çSTICAS" al√©m da aba principal "DETALHES".
3. Se um valor estiver zerado (0,00), significa que o sistema n√£o encontrou aquele campo espec√≠fico no PDF (o que √© comum em faturas zeradas ou com cr√©dito total).